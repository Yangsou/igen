# Node.js with React
# Build a Node.js project that uses React.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '10.x'
  displayName: 'Install Node.js'

- script: |
    npm install
    npm run build
  displayName: 'npm install and build'
- script: |
    npm install -g firebase-tools
  displayName: 'Firebase authenticated'
- script: |
    firebase deploy --token=1/pTgsaIPvHyRejuD7GIJVH7hj5fSbOu2HWnSlJQCD9hbb0wfTkq2TxU06vrqAmNB7 --project igen-dev --only hosting:igen-prod --non-interactive
  displayName: 'deploy on firebase'

trigger:
- develop
pool:
  vmImage: 'ubuntu-latest'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '10.x'
  displayName: 'Install Node.js'

- script: |
    npm install
    npm run build
  displayName: 'npm install and build'
- script: |
    npm install -g firebase-tools
  displayName: 'Firebase authenticated'
- script: |
    firebase deploy --token=1/pTgsaIPvHyRejuD7GIJVH7hj5fSbOu2HWnSlJQCD9hbb0wfTkq2TxU06vrqAmNB7 --project igen-dev --only hosting:igen-dev --non-interactive
  displayName: 'deploy on firebase'


# pipelines:
#   branches:
#     master:
#     - step:
#       name: Install Node and Build
#       caches:
#         - node
#       script:
#         - npm install
#         - npm run build
#     - step:
#       name: Install Firebase
#       caches:
#         - firebase
#       script:
#         - npm install -g firebase-tools
#     - step:
#       name: Deploy
#       development: production
#       caches:
#         - node
#       script:
#         - firebase deploy --token=1/pTgsaIPvHyRejuD7GIJVH7hj5fSbOu2HWnSlJQCD9hbb0wfTkq2TxU06vrqAmNB7 --project igen-dev --only hosting:igen-prod --non-interactive